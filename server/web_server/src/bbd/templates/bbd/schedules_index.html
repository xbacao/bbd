{% extends 'bbd/base.html' %}

<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
{% block content %}
<ul>

<h1>Schedule Manager</h1>

<div class="col-md-1">
	<h3>Valves</h3>
	{% if valve_list %}
	<table border="0" class="table">
	{% for valve in valve_list %}
		<tr><td>
			<form action="#" method="post">
	        {% csrf_token %}
	        	<input type="submit" class="btn btn-default" value="{{valve.valveid}}" name="select_valve">
	    	</form>
		</td></tr>
	{% endfor %}
	</table>
	{% endif %}

</div>
<div class="col-md-11">
	<h3>Schedules</h3>
	{% if schedule_list %}
	<table border="0" class="table">
		<tr>
			<td>ID</td>
			<td>Description</td>
			<td>Created on</td>
			<td>Active</td>
			<td>Deact. Request</td>
			<td>View</td>
		</tr>
	{% for sche in schedule_list %}
		<tr>
			<td>{{sche.scheduleid}}</td>
			<td>{{sche.description}}</td>
			<td>{{sche.created_on}}</td>
			<td>
				{% if sche.active == 1 %}
					<span class="glyphicon glyphicon-ok"></span>
				{% else %}
					<span class="glyphicon glyphicon-remove"></span>
				{% endif %}
			</td>
			<td>
				{% if sche.deactivate_request == 1 %}
					<span class="glyphicon glyphicon-ok"></span>
				{% else %}
					<span class="glyphicon glyphicon-remove"></span>
				{% endif %}
			</td>
			<td>
				<form action="#" method="post">
				{% csrf_token %}
					<input type="hidden" value="{{sche.scheduleid}}" name="sche_id">
					<button class="btn btn-default glyphicon glyphicon-arrow-right" name="view_sche_btn">
				</form>
			</td>
		</tr>
	{% endfor %}
	</table>
	{% endif %}
	<div class="col-md-10"/>
	<div class="col-md-2">
		<form action="#" method="post">
				{% csrf_token %}
					<input type="submit" class="btn btn-default pull-right" value="add schedule" name="add_new">
					<input type="hidden" value="{{valve_id}}" name="valve_id">
		</form>
	</div>

</div>
</ul>

<ul>
{% if sche %}
<script>
function pad(d) {
	d=parseInt(d);
	return (d < 10) ? '0' + d.toString() : d.toString();
}
window.onload = function() {
	var start = document.getElementById("sche_start");
	start.innerHTML=pad({{sche.start_time}}/60) + ':' + pad({{sche.start_time}}%60);
	var stop = document.getElementById("sche_stop");
	stop.innerHTML=pad({{sche.stop_time}}/60) + ':' + pad({{sche.stop_time}}%60);
};
</script>
<p></p>
<h1>Schedule Details</h1>
<table border="0" class="table">
  <tr>
    <td>ID</td><td>{{sche.scheduleid}}</td>
  </tr>
  <tr>
    <td>Valve</td><td>{{sche.valveid_f.valveid}}</td>
  </tr>
  <tr>
    <td>Description</td><td>{{sche.description}}</td>
  </tr>
	<tr>
		<td>Start watering at</td><td id="sche_start"></td>
	</tr>
	<tr>
		<td>Stop watering at</td><td id="sche_stop"></td>
	</tr>
  <tr>
    <td>Active</td>
    <td>
      {% if sche.active == 1 %}
        <span class="glyphicon glyphicon-ok"></span>
      {% else %}
        <span class="glyphicon glyphicon-remove"></span>
      {% endif %}
    </td>
  </tr>
	<tr>
		<td>Deactivate Request</td>
		<td>
			{% if sche.deactivate_request == 1 %}
        <span class="glyphicon glyphicon-ok"></span>
      {% else %}
        <span class="glyphicon glyphicon-remove"></span>
      {% endif %}
		</td>
	</tr>
  <tr>
    <td>Created On</td><td>{{sche.created_on}}</td>
  </tr>
  <tr>
    <td>Schedule activated on</td><td id="sche_start">{{sche.active_start}}</td>
  </tr>
  <tr>
    <td>Schedule deactivated on</td><td id="sche_stop">{{sche.active_end}}</td>
  </tr>
</table>
</ul>
{% endif %}

{% endblock %}
